<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Feed Builder - Admin Panel</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 40px 20px;
            color: #1a202c;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 3em;
            font-weight: 800;
            margin-bottom: 10px;
            text-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.95;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 450px 1fr;
            gap: 30px;
            align-items: start;
        }

        .control-panel {
            background: white;
            border-radius: 24px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            position: sticky;
            top: 20px;
        }

        .control-panel h2 {
            font-size: 1.5em;
            font-weight: 700;
            margin-bottom: 20px;
            color: #1a202c;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #374151;
            font-size: 14px;
        }

        .form-group input[type="text"],
        .form-group input[type="number"],
        .form-group textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 14px;
            font-family: inherit;
            transition: all 0.2s;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #FF0000;
            box-shadow: 0 0 0 3px rgba(255,0,0,0.1);
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .video-url-input {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .video-url-input input {
            flex: 1;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
            font-family: inherit;
        }

        .btn-primary {
            background: #FF0000;
            color: white;
            box-shadow: 0 4px 12px rgba(255,0,0,0.3);
        }

        .btn-primary:hover {
            background: #CC0000;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255,0,0,0.4);
        }

        .btn-secondary {
            background: #f3f4f6;
            color: #374151;
        }

        .btn-secondary:hover {
            background: #e5e7eb;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
            padding: 6px 12px;
            font-size: 12px;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .video-list {
            background: #f9fafb;
            border: 2px dashed #e5e7eb;
            border-radius: 12px;
            padding: 15px;
            min-height: 120px;
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 15px;
        }

        .video-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 12px;
            background: white;
            border-radius: 8px;
            margin-bottom: 8px;
            border: 1px solid #e5e7eb;
        }

        .video-item:last-child {
            margin-bottom: 0;
        }

        .video-item-text {
            flex: 1;
            font-size: 13px;
            color: #6b7280;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            margin-right: 10px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
            margin-bottom: 20px;
        }

        .stat-input input {
            text-align: center;
        }

        .preview-section {
            background: white;
            border-radius: 24px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            min-height: 500px;
        }

        .preview-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .preview-header h2 {
            font-size: 1.5em;
            font-weight: 700;
            color: #1a202c;
        }

        .embed-code-section {
            background: #f9fafb;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .embed-code-section h3 {
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 12px;
            color: #374151;
        }

        .code-box {
            background: #1f2937;
            color: #e5e7eb;
            padding: 16px;
            border-radius: 8px;
            font-family: 'SF Mono', Monaco, monospace;
            font-size: 13px;
            overflow-x: auto;
            position: relative;
        }

        .code-box pre {
            margin: 0;
            white-space: pre-wrap;
            word-break: break-all;
        }

        .copy-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            padding: 6px 12px;
            background: #374151;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            font-weight: 600;
        }

        .copy-btn:hover {
            background: #4b5563;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #9ca3af;
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .empty-state p {
            font-size: 14px;
        }

        .section-divider {
            height: 1px;
            background: #e5e7eb;
            margin: 25px 0;
        }

        @media (max-width: 1200px) {
            .main-grid {
                grid-template-columns: 1fr;
            }

            .control-panel {
                position: relative;
                top: 0;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 20px 10px;
            }

            .header h1 {
                font-size: 2em;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üì∫ YouTube Feed Builder</h1>
            <p>–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–π YouTube –≤–∏–¥–∂–µ—Ç –∑–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–ª–∏–∫–æ–≤</p>
        </div>

        <div class="main-grid">
            <!-- Control Panel -->
            <div class="control-panel">
                <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∏–¥–∂–µ—Ç–∞</h2>

                <div class="form-group">
                    <label for="channelName">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞</label>
                    <input type="text" id="channelName" placeholder="FOR THE LOVE OF GAMING" value="FOR THE LOVE OF GAMING">
                </div>

                <div class="form-group">
                    <label for="channelDescription">–û–ø–∏—Å–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞</label>
                    <input type="text" id="channelDescription" placeholder="Latest gaming videos and trailers" value="Latest gaming videos and trailers">
                </div>

                <div class="form-group">
                    <label>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–∞–Ω–∞–ª–∞</label>
                    <div class="stats-grid">
                        <div class="stat-input">
                            <input type="text" id="followers" placeholder="718" value="718">
                            <label style="font-size: 11px; text-align: center; margin-top: 5px; font-weight: 500;">Followers</label>
                        </div>
                        <div class="stat-input">
                            <input type="text" id="likes" placeholder="338.3K" value="338.3K">
                            <label style="font-size: 11px; text-align: center; margin-top: 5px; font-weight: 500;">Likes</label>
                        </div>
                        <div class="stat-input">
                            <input type="text" id="posts" placeholder="892" value="892">
                            <label style="font-size: 11px; text-align: center; margin-top: 5px; font-weight: 500;">Posts</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="channelUrl">URL –∫–∞–Ω–∞–ª–∞ (–¥–ª—è –∫–Ω–æ–ø–∫–∏ Subscribe)</label>
                    <input type="text" id="channelUrl" placeholder="https://www.youtube.com/@YourChannel" value="https://www.youtube.com/@PlayStation">
                </div>

                <div class="section-divider"></div>

                <div class="form-group">
                    <label>üé• –í–∏–¥–µ–æ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</label>
                    <div class="video-url-input">
                        <input type="text" id="newVideoUrl" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ YouTube URL">
                        <button class="btn btn-primary" onclick="addVideoUrl()">–î–æ–±–∞–≤–∏—Ç—å</button>
                    </div>
                    <div class="video-list" id="videoList">
                        <div class="empty-state">
                            <div class="empty-state-icon">üé¨</div>
                            <p>–î–æ–±–∞–≤—å—Ç–µ YouTube –≤–∏–¥–µ–æ</p>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="maxPosts">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∏–¥–µ–æ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</label>
                    <input type="number" id="maxPosts" min="1" max="12" value="6">
                </div>

                <button class="btn btn-primary" onclick="updatePreview()" style="width: 100%; font-size: 16px; padding: 14px; margin-bottom: 12px;">
                    üîÑ –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–µ–≤—å—é
                </button>

                <div class="form-group" style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #e5e7eb;">
                    <label for="configId">ID –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è)</label>
                    <input type="text" id="configId" placeholder="my-youtube-widget" value="">
                    <small style="display: block; margin-top: 5px; color: #6b7280; font-size: 12px;">
                        –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã, –¥–µ—Ñ–∏—Å—ã –∏ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è
                    </small>
                </div>

                <button class="btn btn-primary" onclick="saveToGitHub()" style="width: 100%; font-size: 16px; padding: 14px; background: #10b981;">
                    üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ GitHub
                </button>

                <div id="saveStatus" style="margin-top: 15px; padding: 12px; border-radius: 8px; display: none;"></div>
            </div>

            <!-- Preview Section -->
            <div class="preview-section">
                <div class="preview-header">
                    <h2>üëÅÔ∏è Live Preview</h2>
                </div>

                <div id="widgetPreview">
                    <script src="./embed.js" data-id="admin-preview"></script>
                </div>

                <div class="embed-code-section">
                    <h3>üìã –ö–æ–¥ –¥–ª—è –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è</h3>
                    <div class="code-box">
                        <button class="copy-btn" onclick="copyEmbedCode()">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                        <pre id="embedCode">&lt;script src="https://youtube-feed.pages.dev/embed.js" data-id="your-config"&gt;&lt;/script&gt;</pre>
                    </div>
                </div>

                <div class="embed-code-section">
                    <h3>‚öôÔ∏è JSON –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</h3>
                    <div class="code-box">
                        <button class="copy-btn" onclick="copyJsonConfig()">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                        <pre id="jsonConfig">{}</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let videoUrls = [
            "https://www.youtube.com/watch?v=9ix7TUGVYIo",
            "https://www.youtube.com/watch?v=5PSNL1qE6VY",
            "https://www.youtube.com/watch?v=3JZ_D3ELwOQ"
        ];

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            console.log('[Admin] Initializing...');
            renderVideoList();
            
            // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ –ø–µ—Ä–≤—ã–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
            setTimeout(() => {
                console.log('[Admin] First update preview');
                updatePreview();
            }, 500);
        });

        function addVideoUrl() {
            const input = document.getElementById('newVideoUrl');
            const url = input.value.trim();
            
            if (!url) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ YouTube URL');
                return;
            }

            // –í–∞–ª–∏–¥–∞—Ü–∏—è YouTube URL
            if (!isValidYouTubeUrl(url)) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π YouTube URL');
                return;
            }

            videoUrls.push(url);
            input.value = '';
            renderVideoList();
            updatePreview();
        }

        function removeVideoUrl(index) {
            videoUrls.splice(index, 1);
            renderVideoList();
            updatePreview();
        }

        function renderVideoList() {
            const container = document.getElementById('videoList');
            
            if (videoUrls.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üé¨</div>
                        <p>–î–æ–±–∞–≤—å—Ç–µ YouTube –≤–∏–¥–µ–æ</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = videoUrls.map((url, index) => `
                <div class="video-item">
                    <span class="video-item-text">${url}</span>
                    <button class="btn btn-danger" onclick="removeVideoUrl(${index})">‚úï</button>
                </div>
            `).join('');
        }

        function isValidYouTubeUrl(url) {
            const patterns = [
                /youtube\.com\/watch\?v=/,
                /youtu\.be\//,
                /youtube\.com\/embed\//,
                /youtube\.com\/v\//
            ];
            return patterns.some(pattern => pattern.test(url));
        }

        function generateConfig() {
            const config = {
                widgetTitle: document.getElementById('channelName').value || "YouTube Channel Feed",
                widgetDescription: document.getElementById('channelDescription').value || "Latest videos",
                channelStats: {
                    subscribers: document.getElementById('followers').value || "‚Äî",
                    likes: document.getElementById('likes').value || "‚Äî",
                    videos: document.getElementById('posts').value || "‚Äî"
                },
                channelUrl: document.getElementById('channelUrl').value || "",
                maxPosts: parseInt(document.getElementById('maxPosts').value) || 6,
                showChannelStats: true,
                showTimestamp: true,
                showMedia: true,
                autoFetchMeta: true,
                videoUrls: videoUrls.slice(), // –ö–æ–ø–∏—è –º–∞—Å—Å–∏–≤–∞
                style: {
                    fontFamily: "'Inter', -apple-system, BlinkMacSystemFont, sans-serif",
                    colors: {
                        background: "#ffffff",
                        text: "#1a1a1a",
                        title: "#1a202c",
                        description: "#4a5568",
                        author: "#111827",
                        time: "#6b7280",
                        content: "#374151",
                        action: "#6b7280",
                        cardBg: "#ffffff",
                        cardBorder: "#e5e7eb",
                        borderHover: "#d1d5db",
                        avatarBorder: "#f3f4f6",
                        actionsBorder: "#f3f4f6",
                        logoBg: "linear-gradient(135deg, #FF0000 0%, #CC0000 100%)",
                        accent: "#FF0000",
                        chipBg: "#f1f5f9",
                        chipBorder: "#e2e8f0"
                    },
                    borderRadius: {
                        widget: 24,
                        blocks: 16
                    },
                    sizes: {
                        fontSize: 1.0,
                        padding: 32,
                        blockPadding: 20,
                        gap: 20,
                        cardWidth: 340,
                        cardMinHeight: 380
                    },
                    shadow: {
                        widget: "0 8px 32px rgba(0,0,0,0.08)",
                        card: "0 4px 12px rgba(0,0,0,0.05)",
                        cardHover: "0 12px 24px rgba(255,0,0,0.15)"
                    }
                }
            };
            
            console.log('[Admin] Generated config:', config);
            console.log('[Admin] Video URLs count:', config.videoUrls.length);
            
            return config;
        }

        function updatePreview() {
            try {
                console.log('[Admin] updatePreview() called');
                const config = generateConfig();
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ localStorage –¥–ª—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞
                localStorage.setItem('admin-preview-config', JSON.stringify(config));
                console.log('[Admin] Config saved to localStorage');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º JSON –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
                const jsonConfigEl = document.getElementById('jsonConfig');
                if (jsonConfigEl) {
                    jsonConfigEl.textContent = JSON.stringify(config, null, 2);
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º embed –∫–æ–¥
                const configId = document.getElementById('configId').value.trim() || 'your-config';
                const embedCode = `<script src="https://youtube-feed.pages.dev/embed.js" data-id="${configId}"></script>`;
                const embedCodeEl = document.getElementById('embedCode');
                if (embedCodeEl) {
                    embedCodeEl.textContent = embedCode;
                }
                
                // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –≤–∏–¥–∂–µ—Ç
                const previewContainer = document.getElementById('widgetPreview');
                if (!previewContainer) {
                    console.error('[Admin] widgetPreview container not found!');
                    return;
                }
                
                // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –≤–∏–¥–∂–µ—Ç—ã
                const oldWidgets = document.querySelectorAll('[id^="youtube-widget-"]');
                console.log('[Admin] Removing', oldWidgets.length, 'old widgets');
                oldWidgets.forEach(el => el.remove());
                
                // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
                previewContainer.innerHTML = '';
                
                // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –Ω–æ–≤–æ–≥–æ –≤–∏–¥–∂–µ—Ç–∞
                setTimeout(() => {
                    console.log('[Admin] Loading new widget...');
                    const newScript = document.createElement('script');
                    newScript.src = 'https://youtube-feed.pages.dev/embed.js?t=' + Date.now();
                    newScript.dataset.id = 'admin-preview';
                    newScript.onerror = function() {
                        console.error('[Admin] Failed to load embed.js');
                    };
                    newScript.onload = function() {
                        console.log('[Admin] embed.js loaded successfully');
                    };
                    previewContainer.appendChild(newScript);
                }, 100);
                
            } catch (error) {
                console.error('[Admin] Error in updatePreview:', error);
            }
        }

        function copyEmbedCode() {
            const code = document.getElementById('embedCode').textContent;
            navigator.clipboard.writeText(code).then(() => {
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = '‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
                setTimeout(() => {
                    btn.textContent = originalText;
                }, 2000);
            });
        }

        function copyJsonConfig() {
            const code = document.getElementById('jsonConfig').textContent;
            navigator.clipboard.writeText(code).then(() => {
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = '‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
                setTimeout(() => {
                    btn.textContent = originalText;
                }, 2000);
            });
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ GitHub
        async function saveToGitHub() {
            const configId = document.getElementById('configId').value.trim();
            const statusDiv = document.getElementById('saveStatus');
            
            if (!configId) {
                statusDiv.style.display = 'block';
                statusDiv.style.background = '#fee2e2';
                statusDiv.style.border = '2px solid #ef4444';
                statusDiv.innerHTML = '‚ùå –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ ID –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏';
                return;
            }

            // –í–∞–ª–∏–¥–∞—Ü–∏—è ID
            const validIdPattern = /^[a-zA-Z0-9_-]+$/;
            if (!validIdPattern.test(configId)) {
                statusDiv.style.display = 'block';
                statusDiv.style.background = '#fee2e2';
                statusDiv.style.border = '2px solid #ef4444';
                statusDiv.innerHTML = '‚ùå ID –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã, –¥–µ—Ñ–∏—Å—ã –∏ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è';
                return;
            }

            const config = generateConfig();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            statusDiv.style.display = 'block';
            statusDiv.style.background = '#dbeafe';
            statusDiv.style.border = '2px solid #3b82f6';
            statusDiv.innerHTML = '‚è≥ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ GitHub...';

            try {
                // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ GitHub
                let response = await fetch('https://youtube-feed.pages.dev/api/save-to-github', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        configId: configId,
                        config: config
                    })
                });

                let result = await response.json();

                // –ï—Å–ª–∏ GitHub –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ–±—ã—á–Ω—ã–π save-config
                if (!result.success && result.error && result.error.includes('not configured')) {
                    console.log('GitHub not configured, using fallback API');
                    response = await fetch('https://youtube-feed.pages.dev/api/save-config', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            configId: configId,
                            config: config
                        })
                    });
                    result = await response.json();
                }

                if (result.success) {
                    statusDiv.style.background = '#d1fae5';
                    statusDiv.style.border = '2px solid #10b981';
                    
                    let statusHtml = `
                        <strong>‚úÖ –£—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ!</strong><br>
                        <small style="color: #065f46;">Config ID: <strong>${configId}</strong></small><br>
                        <small style="color: #065f46; word-break: break-all;">${result.message}</small>
                    `;
                    
                    if (result.githubUrl) {
                        statusHtml += `<br><a href="${result.githubUrl}" target="_blank" style="color: #059669; text-decoration: underline;">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ GitHub</a>`;
                    }
                    
                    statusDiv.innerHTML = statusHtml;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º embed –∫–æ–¥
                    const embedCode = `<script src="https://youtube-feed.pages.dev/embed.js" data-id="${configId}"></script>`;
                    document.getElementById('embedCode').textContent = embedCode;
                } else {
                    throw new Error(result.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞');
                }
            } catch (error) {
                statusDiv.style.background = '#fee2e2';
                statusDiv.style.border = '2px solid #ef4444';
                statusDiv.innerHTML = `
                    <strong>‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è</strong><br>
                    <small style="color: #991b1b;">${error.message}</small><br>
                    <small style="color: #991b1b;">–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –°–∫–æ–ø–∏—Ä—É–π—Ç–µ JSON –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –Ω–∏–∂–µ –∏ —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª configs/${configId}.json –≤—Ä—É—á–Ω—É—é –≤ GitHub.</small>
                `;
            }
        }

        // –°–ª—É—à–∞—Ç–µ–ª—å –¥–ª—è Enter –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞ URL
        document.getElementById('newVideoUrl').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addVideoUrl();
            }
        });

        // –°–ª—É—à–∞—Ç–µ–ª—å –¥–ª—è Enter –≤ –ø–æ–ª–µ config ID
        document.getElementById('configId').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                saveToGitHub();
            }
        });

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ–ª–µ–π
        ['channelName', 'channelDescription', 'followers', 'likes', 'posts', 'channelUrl', 'maxPosts'].forEach(id => {
            const element = document.getElementById(id);
            if (element) {
                element.addEventListener('input', function() {
                    console.log('[Admin] Field changed:', id, this.value);
                    // –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
                    clearTimeout(window.updateTimeout);
                    window.updateTimeout = setTimeout(() => {
                        console.log('[Admin] Updating preview after input');
                        updatePreview();
                    }, 800);
                });
            }
        });

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ ID
        function generateRandomId() {
            const timestamp = Date.now().toString(36);
            const random = Math.random().toString(36).substring(2, 7);
            return `widget-${timestamp}-${random}`;
        }

        // –ö–Ω–æ–ø–∫–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω–æ–≥–æ ID
        document.getElementById('configId').addEventListener('focus', function() {
            if (!this.value) {
                this.value = generateRandomId();
            }
        });

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ ID
        function generateRandomId() {
            const timestamp = Date.now().toString(36);
            const random = Math.random().toString(36).substring(2, 7);
            return `widget-${timestamp}-${random}`;
        }

        // –ö–Ω–æ–ø–∫–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω–æ–≥–æ ID
        document.getElementById('configId').addEventListener('focus', function() {
            if (!this.value) {
                this.value = generateRandomId();
            }
        });
    </script>
</body>
</html>
